<div class="page-wrapper">
  <app-breadcrumb [pageTitle]="pageTitle" [breadcrumbs]="breadcrumbs"></app-breadcrumb>

  <!-- Filters -->
  <div class="filters card p-3 mb-3">
    <div class="row g-3">
      <div class="col-md-3">
        <select class="form-select" [(ngModel)]="filterDepartment" (change)="applyFilters()">
          <option value="All">All Departments</option>
          <option value="Maths">Maths</option>
          <option value="Science">Science</option>
          <option value="English">English</option>
          <option value="Sports">Sports</option>
          <option value="Admin">Admin</option>
        </select>
      </div>

      <div class="col-md-3">
        <select class="form-select" [(ngModel)]="filterStatus" (change)="applyFilters()">
          <option value="All">All Status</option>
          <option value="Present">Present</option>
          <option value="Absent">Absent</option>
          <option value="Late">Late</option>
        </select>
      </div>

      <div class="col-md-4 d-flex gap-2">
        <input type="date" class="form-control" [(ngModel)]="startDate" (change)="applyFilters()" />
        <input type="date" class="form-control" [(ngModel)]="endDate" (change)="applyFilters()" />
      </div>
    </div>
  </div>

  <!-- Attendance Table -->
  <div class="card p-4 mt-4 radius">
    <!-- Export Buttons -->
    <div class="d-flex justify-content-end mb-3 gap-2">
      <button class="btn btn-success" (click)="exportToExcel()">⬇️ Export Excel</button>
      <button class="btn btn-danger" (click)="exportToPDF()">⬇️ Export PDF</button>
    </div>

    <app-table-header
      [(searchTerm)]="searchTerm"
      [pageSizeOptions]="pageSizeOptions"
      [(pageSize)]="pageSize"
      (pageSizeChange)="onPageSizeChange()"
      (searchChange)="onSearchChange()"
      [routeurl]="addStaffUrl"
    ></app-table-header>

    <div class="table-responsive">
      <table class="table table-bordered table-hover">
        <thead class="table-light">
          <tr>
            <th>Emp ID</th>
            <th>Name</th>
            <th>Department</th>
            <th>Designation</th>
            <th>Date</th>
            <th>Status</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let staff of paginatedAttendence">
            <td>{{ staff.empId }}</td>
            <td>{{ staff.name }}</td>
            <td>{{ staff.department }}</td>
            <td>{{ staff.designation }}</td>
            <td>{{ staff.date }}</td>
            <td>
              <span class="badge"
                [ngClass]="{
                  'bg-success': staff.status === 'Present',
                  'bg-danger': staff.status === 'Absent',
                  'bg-warning text-dark': staff.status === 'Late'
                }">
                {{ staff.status }}
              </span>
            </td>
          </tr>
          <tr *ngIf="paginatedAttendence.length === 0">
            <td colspan="6" class="text-center">No records found</td>
          </tr>
        </tbody>
      </table>
    </div>

    <!-- Footer Component -->
    <app-table-footer
      [currentPage]="currentPage"
      [pageSize]="pageSize"
      [totalItems]="filteredAttendence.length"
      [totalPages]="totalPages"
      (pageChange)="changePage($event)"
    ></app-table-footer>
  </div>
</div>
